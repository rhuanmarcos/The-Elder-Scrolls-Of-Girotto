let mapa4 = [  ['*', "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*"],//0
              ['*', "#", "#", "#", "#", "_", "_", "_", "*", "_", "_", "_", "_", "_", "*", "_", "_", "_", "#", "#", "#", "_", "_", "_", "_", "*", "_", "_", "_", "#", "_", "*", "_", "_", "_", "_", "_", "#", "#", "*"],//1
              ['*', "#", "@", "_", "#", "_", "_", "_", "*", "_", "#", "_", "#", "_", "*", "_", "_", "_", "_", "@", "_", "_", "_", "_", "_", "*", "_", "#", "_", "#", "_", "*", "_", "_", "_", "#", "_", "@", "#", "*"],//2
              ['*', "#", "_", "_", "_", "_", "_", "_", "*", "_", "#", "_", "#", "#", "*", "_", "_", "_", "#", "#", "#", "_", "_", "_", "_", "*", "_", "#", "_", "_", "_", "*", "_", "_", "_", "#", "#", "_", "_", "*"],//3
              ['*', "#", "#", "_", "_", "_", "_", "_", "*", "_", "#", "_", "#", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "#", "_", "#", "_", "*", "_", "_", "_", "_", "#", "#", "_", "*"],//4
              ['*', "_", "_", "_", "_", "_", "_", "_", "*", "_", "#", "_", "#", "#", "*", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "*", "#", "#", "_", "#", "_", "*", "_", "_", "_", "_", "_", "_", "_", "*"],//5
              ['*', "_", "_", "_", "_", "_", "_", "_", "*", "_", "#", "_", "#", "_", "*", "_", "_", "_", "_", ">", "_", "_", "_", "_", "_", "*", "#", "#", "#", "#", "_", "*", "_", "<", "_", "_", "_", "_", "_", "*"],//6
              ['*', "_", "_", "_", "_", "_", "_", ">", "*", "_", "#", "_", "#", "_", "*", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "*", "_", "_", "_", "_", "_", "*", "_", "_", "_", "_", "_", "_", "_", "*"],//7
              ['*', "*", "*", "*", "*", "_", "*", "*", "*", "#", "#", "_", "#", "_", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "#", "_", "#", "#", "#", "*", "*", "*", "*", "*", "_", "*", "*", "*"],//8
              ['*', "_", "_", "_", "#", "_", "_", "#", "_", "_", "_", "_", "#", "_", "_", "_", "_", "_", "_", "#", "_", "#", "_", "#", "_", "_", "_", "_", "#", "_", "_", "_", "_", "_", "_", "#", "_", "#", "#", "*"],//9
              ['*', "_", "#", "_", "#", "_", "_", "#", "_", "_", "#", "_", "#", "#", "#", "#", "_", "#", "_", "#", "_", "#", "_", "#", "#", "#", "#", "_", "#", "#", "#", "_", "_", "_", "_", "#", "_", "_", "_", "*"],//10
              ['*', "_", "#", "_", "#", "_", "_", "#", "#", "#", "#", "_", "_", "_", "_", "#", "_", "#", "_", "_", "_", "_", "_", "#", "_", "#", "#", "_", "_", "_", "#", "#", "#", "#", "_", "#", "#", "#", "_", "*"],//11
              ['*', "_", "#", "_", "#", "_", "_", "_", "_", "#", "#", "_", "_", "#", "#", "#", "_", "#", "#", "#", "#", "#", "#", "#", "_", "#", "#", "_", "_", "_", "#", "_", "_", "_", "_", "_", "_", "_", "_", "*"],//12
              ['*', "_", "#", "_", "#", "#", "#", "#", "_", "#", "#", "_", "#", "#", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "#", "#", "#", "#", "_", "#", "_", "#", "#", "_", "#", "#", "#", "#", "*"],//13
              ['*', "_", "#", "_", "#", "_", "_", "_", "_", "#", "#", "_", "_", "_", "_", "#", "#", "#", "#", "#", "#", "#", "_", "#", "#", "#", "#", "_", "_", "_", "#", "_", "#", "#", "_", "#", "_", "_", "_", "*"],//14
              ['*', "_", "#", "_", "#", "_", "#", "_", "#", "_", "_", "#", "#", "#", "#", "#", "_", "_", "_", "_", "_", "#", "_", "#", "_", "_", "#", "_", "#", "#", "#", "_", "#", "#", "#", "#", "#", "#", "_", "*"],//15
              ['*', "_", "#", "#", "#", "_", "#", "#", "#", "<", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "#", "_", "#", "_", "_", "_", "_", "#", "#", "_", "_", "_", "#", "_", "_", "_", "_", "_", "*"],//16
              ['*', "_", "#", "_", "_", "_", "#", "_", "#", "_", "#", "#", "#", "#", "#", "_", "_", "_", "_", "_", "_", "#", "_", "#", "#", "_", "#", "#", "#", "#", "#", "#", "_", "#", "_", "#", "#", "#", "#", "*"],//17
              ['*', "_", "#", "_", "#", "_", "#", "_", "#", "#", "#", "_", "_", "_", "#", "_", "_", "_", "*", "*", "*", "#", "_", "_", "_", "_", "#", "_", "_", "_", "_", "_", "_", "#", "_", "_", "_", "_", "_", "*"],//18
              ['*', "_", "#", "_", "#", "_", "#", "_", "#", "_", "#", "_", "#", "_", "#", "_", "_", "_", "*", ">", "*", "#", "_", "_", "#", "_", "#", "#", "_", "#", "_", "_", "_", "#", "_", "#", "_", "_", "#", "*"],//19
              ['*', "_", "_", "_", "#", "_", "#", "_", "#", "_", "#", "_", "#", "_", "#", "_", "_", "_", "*", "D", "*", "#", "#", "#", "#", "_", "_", "#", "_", "#", "#", "#", "#", "#", "#", "#", "#", "_", "#", "*"],//20
              ['*', "#", "#", "#", "#", "_", "#", "#", "#", "_", "#", "_", "#", "_", "#", "_", "_", "_", "*", "_", "*", "_", "_", "_", "_", "_", "_", "#", "_", "_", "_", "#", "_", "_", "_", "_", "_", "_", "_", "*"],//21
              ['*', "_", "_", "_", "_", "_", "_", "_", "_", "_", "#", "#", "#", "_", "#", "#", "#", "#", "*", "D", "*", "_", "_", "#", "#", "#", "_", "#", "#", "#", "_", "#", "#", "#", "_", "#", "#", "#", "#", "*"],//22
              ['*', "_", "#", "#", "#", "#", "#", "#", "#", "_", "_", "_", "_", "_", "_", "_", "_", "_", "*", "_", "*", "<", "_", "#", "_", "_", "_", "_", "_", "#", "_", "_", "_", "_", "_", "#", "_", "_", "_",  "*"],//23
              ['*', "_", "#", "_", "_", "_", "#", "_", "*", "*", "*", "*", "*", "*", "*", "*", "*", "#", "*", "D", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "_", "#", "#", "#", "#", "#", "_", "*"],//24
              ['*', "_", "#", "_", "#", "_", "#", "_", "*", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "_", "*", "_", "#", "#", "_", "_", "#", "_", "*"],//25
              ['*', "_", "#", "_", "#", "_", "#", "_", "*", "_", "#", "#", "#", "#", "#", "#", "#", "#", "_", "_", "_", "#", "#", "#", "#", "#", "#", "_", "#", "#", "_", "*", "_", "#", "#", "_", "_", "_", "_", "*"],//26
              ['*', "_", "#", "_", "#", "_", "_", "_", "*", "_", "#", "_", "_", "_", "_", "_", "_", "#", "_", "_", "_", "#", "_", "_", "_", "_", "#", "_", "_", "#", "_", "*", "_", "_", "_", "_", "_", "#", "_", "*"],//27
              ['*', "_", "#", "_", "#", "#", "#", "#", "*", "_", "#", "_", "#", "#", "#", "_", "#", "#", "#", "#", "#", "#", "_", "#", "#", "_", "#", "#", "_", "#", "_", "*", "_", "_", "#", "_", "#", "#", "_", "*"],//28
              ['*', "_", "#", "_", "_", "_", "_", "_", "*", "_", "#", "_", "#", "_", "_", "_", "#", "_", "_", "_", "_", "_", "_", "#", "#", "_", "_", "#", "_", "#", "_", "*", "_", "_", "#", "_", "#", "_", "_", "*"],//29
              ['*', "_", "#", "#", "_", "#", "#", "#", "*", "_", "#", "_", "#", "_", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "#", "_", "#", "_", "#", "_", "*", "#", "#", "#", "_", "#", "_", "#", "*"],//30
              ['*', "_", "_", "_", "_", "_", "_", "_", "*", "_", "#", "_", "#", "_", "#", "_", "_", "_", "_", "_", "_", "_", "#", "#", "#", "#", "_", "#", "_", "#", "#", "*", "_", "_", "_", "_", "#", "_", "#", "*"],//31
              ['*', "_", "_", "_", "_", "#", "_", "_", "*", "_", "#", "_", "#", "_", "#", "_", "#", "#", "#", "#", "#", "_", "#", "#", "#", "#", "_", "#", "_", "_", "_", "*", "_", "#", "_", "_", "#", "_", "#", "*"],//32
              ['*', "_", "_", "#", "_", "#", "_", "_", "*", "_", "#", "_", "#", "_", "#", "_", "_", "_", "_", "_", "#", "_", "_", "_", "#", "#", "_", "#", "#", "#", "_", "*", "_", "#", "_", "_", "#", "_", "#", "*"],//33
              ['*', "_", "_", "#", "_", "#", "_", "_", "*", "_", "_", "_", "#", "_", "#", "_", "#", "#", "#", "_", "#", "#", "#", "_", "#", "#", "_", "#", "_", "_", "_", "*", "_", "#", "#", "#", "#", "_", "#", "*"],//34
              ['*', "#", "#", "#", "_", "#", "#", "#", "*", "#", "#", "#", "#", "_", "#", "_", "#", "_", "_", "_", "_", "_", "#", "_", "#", "#", "_", "#", "_", "#", "_", "*", "_", "#", "_", "_", "_", "_", "_", "*"],//35
              ['*', "_", "_", "_", "_", "_", "_", "_", "*", "_", "_", "_", "_", "_", "#", "_", "#", "_", "o", "o", "o", "_", "#", "_", "#", "#", "_", "_", "_", "#", "_", "*", "_", "#", "_", "#", "_", "#", "#", "*"],//36
              ['*', "_", ">", "_", "_", "_", "_", "_", "*", "_", "#", "#", "#", "#", "#", "_", "#", "_", "_", "_", "_", "_", "#", "_", "#", "#", "#", "#", "#", "#", "_", "*", "_", "_", "_", "#", "_", "_", "_", "*"],//37
              ['*', "_", "_", "_", "_", "_", "_", "_", "*", "_", "_", "_", "_", "_", "_", "_", "#", "_", "_", "_", "_", "_", "#", "_", "_", "_", "_", "_", "_", "_", "_", "*", "_", "_", "_", "#", "_", "_", ">", "*"],//38
              ['*', "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "D", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*", "*"]];//39
              //0    1    2    3    4    5    6    7    8    9    10   11   12   13   14  15   16   17   18   19   20   21   22   23    24   25   26   27   28   29   30  31   32   33   34   35   36   37   38   39    


 let x = 19;
 let y = 15;

let chave1 = true;
let chave2 = true;
let chave3 = true;

let botao1 = true;
let botao2 = true;
let botao3 = true;

let tp1 = true;
let tp11 = true;
let tp2 = true;
let tp22 = true;
let tp3 = true;
let tp33 = true;
let tp4 = true;
let tp44 = true;

let imune = false;
let mapa4Inicial = mapa4
const estadoInicial=[mapa4,chave1,chave2,chave3,botao1,botao2,botao3]
let vidas = 3
function desenharmapa() {
  let texto = "";
  if (!chave1) {
    mapa4[20][19]='='
  }else {
    mapa4[2][2]='@'
    mapa4[20][19]='D'
  }if (!chave2) {
    mapa4[22][19]='='
  }else{
    mapa4[2][19]='@'
    mapa4[22][19]='D'
  }if (!chave3) {
    mapa4[24][19]='='
  }else{
    mapa4[2][37]='@'
    mapa4[24][19]='D'
/*y = linha e x= coluna*/
//tp1 16 9| 37 2 
//tp2 7 7 | 23 21
//tp3 6 19 |38 38
//tp4 6 33 | 19 19
//c1 2 2|20 19
//c2 2 19 |22 19
//c3 2 37 |24 19
// but1 36 18
//but2  36 20 
//but3  36 19
//v 39 19
//?1 1 7
//?2 1 15   
//?3 1 32
//§ 29 18
  }if (!tp1) {
    mapa4[16][9]='<' 
  }else {
    mapa4[16][9]='<'
  }if (!tp11) {
    mapa4[37][2]= "<"
  }else {
    mapa4[37][2]= "<"
  }if (!tp2) {
    mapa4[7][7]='<' 
  }else {
    mapa4[7][7]='<'
  }if (!tp22) {
    mapa4[23][21]= "<"
  }else {
    mapa4[23][21]= "<"
  }if (!tp3) {
    mapa4[6][19]='<' 
  }else {
    mapa4[6][19]='<'
  }if (!tp33) {
    mapa4[38][38]= "<"
  }else {
    mapa4[38][38]= "<"
  }if (!tp4) {
    mapa4[6][33]='<' 
  }else {
    mapa4[6][33]='<'
  }if (!tp44) {
    mapa4[19][19]= "<"
  }else {
    mapa4[19][19]= "<"  
  }if (!botao1) { 
    mapa4[36][18]='_'
  }else{
    mapa4[36][18]='o'
  }if (!botao2) {
    mapa4[36][20]='_'
  }else{
    mapa4[36][20]='o'
  }if (!botao3) {
    mapa4[36][19]='_'
    mapa4[39][19]="="
  }else{
    mapa4[36][19]='o'
  }
  mapa4[y][x] = '&';
  for (let i = 0; i < 40; i++) {
    for (let j = 0; j < 40; j++) {
      if (mapa4[i][j] === '_') {
        texto += `<span style="color: transparent">_ </span>`;
      } else if (mapa4[i][j] === '#') {
        texto += `<span style="color: green"># </span>`;
      }else if (mapa4[i][j] === '@') {
        texto += `<span style="color: yellow">@ </span>`;
      } else if (mapa4[i][j] === '*') {
        texto += `<span style="color: aqua">* </span>`;
      }else if (mapa4[i][j] === 'D') {
        texto += `<span style="color: Brown">D </span>`;
      }else {
        texto += `${mapa4[i][j]} `;
      }
    }
    texto += `\n`;
  }
  
  
  document.getElementById('mapa4').innerHTML = texto;
  }
  
  function vida(params) {
    if (!imune && vidas > 0 ) {
      alert('você perdeu uma vida')
          mapa4 = estadoInicial[0];
          chave1 = estadoInicial[1];
          chave2 = estadoInicial[2];
          chave3 = estadoInicial[3];
          botao1= estadoInicial[4];
          botao2 = estadoInicial[5];
          botao3 = estadoInicial[6];
         
          x=19
          y=15
          vidas -=1
          document.getElementById('vidas').textContent = `Vidas: ${vidas}`;
    }if (vidas == 0) {
    
        window.open("../html/derrota.html", "_self");
     
    } 
  }
desenharmapa();
document.addEventListener('keydown', (evento) => {
  
  console.log(y)
  console.log(x)

  mapa4[y][x] = '_';
 
switch (evento.key) {
  case 'w':
    if ( mapa4[y-1][x] !== '*' && mapa4[y-1][x] !== 'D' ) {
      if (mapa4[y-1][x]==="#") {
         vida()
      }else {
         y -= 1;
      }
  }  
      break;
  case 's':
    if ( mapa4[y+1][x] !== '*' && mapa4[y+1][x] !== 'D' ) {
      if (mapa4[y+1][x]==="#") {
         vida()
      }else {
         y += 1;
      }
  }  
    break;
  case 'a':
    if ( mapa4[y][x-1] !== '*' && mapa4[y][x-1] !== 'D' ) {
      if (mapa4[y][x-1]==="#") {
         vida()
      }else {
         x-= 1;
      }
  }  
    break;
  case 'd':
    if ( mapa4[y][x+1] !== '*' && mapa4[y][x+1] !== 'D' ) {
      if (mapa4[y][x+1]==="#") {
         vida()
      }else {
         x += 1;
      }
  }  
    break;
  case 'ç':
        imune = !imune   
           console.log('Modo imune '+imune);
    break;
    case 'i':
    if (y==2 && x==2) {
        chave1 = false
      }else if (y==2 && x==19) {
        chave2 = false
      }else if (y==2 &&x==37) {
        chave3 = false
      }else if (y==36 && x==18) {
        botao1= false
      }else if (y==36 && x==20 &&!botao1) {
        botao2= false
      }else if (y==36 && x==19 &&!botao2) {
        botao3= false
      }else if (y==1 && x ==7) {
        dicas1 = false
      }else if (y==1 && x ==15) {
        dicas2 = false
      }else if (y==1 && x ==32) {
        dicas3 = false
      }else if (y==29 && x==18) {
        rv = false;
      }
      else if (y == 16 && x == 9 && tp1) {
        y = 37;
        x = 2;
      } else if (y == 37 && x == 2 && tp11) {
        y = 16;
        x = 9;
      }else if (y == 7 && x == 7 && tp2) {
        y = 23;
        x = 21;
      } else if (y == 23 && x == 21 && tp22) {
        y = 7;
        x = 7;
      }else if (y == 6 && x == 19 && tp3) {
        y = 38;
        x = 38;
      } else if (y == 38 && x == 38 && tp33) {
        y = 6;
        x = 19;
      }else if (y == 6 && x == 33 && tp4) {
        y = 19;
        x = 19;
      } else if (y == 19 && x == 19 && tp44) {
        y = 6;
        x = 33;
      }
      break;
      /*y = linha e x= coluna*/
//tp1 16 9| 37 2 
//tp2 7 7 | 23 21
//tp3 6 19 |38 38
//tp4 6 33 | 19 19
//c1 2 2|20 19
//c2 2 19 |22 19
//c3 2 37 |24 19
// but1 36 18
//but2  36 20 
//but3  36 19
//v 39 19
//?1 1 7
//?2 1 15   
//?3 1 32
  } 
desenharmapa();
  if (y == 39 && x == 19) {
    mapa4[39][19] = '=';
    desenharmapa();
  
    alert('Você concluiu a quarta fase!')
    window.location.href = '../html/vitoria.html';
  }
  });
function voltar() {
  window.open("../html/menu.html", "_self");
}